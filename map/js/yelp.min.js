function initialize(){map=new google.maps.Map(document.getElementById("map"),{zoom:16,center:coords}),hideLoading()}function showMarkers(e,t){var n=new google.maps.LatLngBounds;if(e){var a=new google.maps.Marker({position:e,map:map,label:t});google.maps.event.addListener(a,"click",function(){var e=map.getZoom();map.setZoom(16),map.setCenter(a.getPosition()),window.setTimeout(function(){map.setZoom(e)},5e3)}),markers.push(a)}for(var s=0;s<markers.length;s++)n.extend(markers[s].getPosition());map.fitBounds(n),map.setZoom(map.getZoom())}function clearMarkers(e){for(var t=0;t<markers.length;t++)markers[t].setMap(e)}function sendRequest(){showLoading();var e=map.getCenter(),t=map.getBounds().getNorthEast(),n=Math.round(google.maps.geometry.spherical.computeDistanceBetween(e,t)),a=new XMLHttpRequest,s=encodeURI(document.getElementById("search").value);a.open("GET","php/proxy.php?term="+s+"&latitude="+e.lat()+"&longitude="+e.lng()+"&radius="+n+"&limit=10"),a.setRequestHeader("Accept","application/json"),a.onreadystatechange=function(){if(4==this.readyState){hideLoading();var e=JSON.parse(this.responseText);console.log(e),createTitles(e,n)}},a.send(null)}function createTitles(e,t){clearMarkers(null);var n=document.getElementById("orderedList");if(n.innerHTML="",e.businesses&&0!=e.businesses.length)for(var a=0;a<e.businesses.length;a++){var s=document.createElement("li"),r=document.createElement("p"),o=document.createElement("a"),i=document.createElement("img"),l=document.createElement("p"),m=document.createElement("img");m.setAttribute("src","images/"+e.businesses[a].rating+".png"),r.innerHTML=a+1+" ) Title : "+e.businesses[a].name,o.setAttribute("href",e.businesses[a].url),o.setAttribute("target","_blank"),o.appendChild(r),i.setAttribute("src",e.businesses[a].image_url),l.innerHTML="Rating : "+e.businesses[a].rating+"<br>",s.appendChild(o),s.appendChild(i),s.appendChild(l),l.appendChild(m),n.appendChild(s),showMarkers({lat:e.businesses[a].coordinates.latitude,lng:e.businesses[a].coordinates.longitude},a+1+"")}else n.innerHTML="<h1>NO RESTAURANT FOUND</h1>";t>=12539&&(n.innerHTML="<h1>Error Code : </h1><br>"+e.error.code+"<h1> Description : </h1><br>"+e.error.description+" <br> <h2>Solution :</h2> Radius of search area too large Click zoom and search again")}function showLoading(){document.getElementById("loadingImage").style.display="block"}function hideLoading(){document.getElementById("loadingImage").style.display="none"}var map,markers=[],coords={lat:32.75,lng:-97.13};